{% extends 'partials/_master.twig' %}

{% block main %}

    <h2>{{ record.title }}</h2>

    {# Output all fields, in the order as defined in the contenttype.
       To change the generated html and configure the options, see:
       https://docs.bolt.cm/templates/fields-tag #}
  <table>
     <tbody>
      <tr>
        <td>Einsatzart</td>
        {% setcontent operationtype = "operationtypes" where { 'id': record.operationtype } returnsingle %}
        <td>{{operationtype.title}}</td>
      </tr>
      <tr>
        <td>Einsatzort</td>
        <td>{{record.location}}</td>
      </tr>
      <tr>
        <td>Alarmierung</td>
        <td>{{record.beginat|localedatetime('%d.%m.%Y %H:%M Uhr')}}</td>
      </tr>
      <tr>
        <td>Einsatzende</td>
        <td>{{record.endat|localedatetime('%d.%m.%Y %H:%M Uhr')}}</td>
      </tr>
      <tr>
        <td>Einsatzleiter</td>
        <td>{{record.incidentcommander}}</td>
      </tr>
      {% include 'partials/_operation_vehicles.twig' with { 'intern': true, 'record': record } %}
      {% include 'partials/_operation_vehicles.twig' with { 'intern': false, 'record': record } %}        
      <tr>
        <td colspan="2">
          <div id="map" style="width: 100%; height: 300px;"></div>
        </td>
      </tr>
      <tr>
        <td colspan="2">
          {{record.description|markdown}}
        </td>
      </tr>
     </tbody>
   </table>
   <div class="orbit" role="region" aria-label="Einsatzbilder" data-orbit>
      <ul class="orbit-container">
        <button class="orbit-previous"><span class="show-for-sr">Previous Slide</span>&#9664;&#xFE0E;</button>
        <button class="orbit-next"><span class="show-for-sr">Next Slide</span>&#9654;&#xFE0E;</button>
         {% for image in record.imagelist %}
          <li class="orbit-slide">
            <img class="orbit-image" src="{{ thumbnail(image.filename) }}" alt="{{image.title}}">
            <figcaption class="orbit-caption">{{image.title}}</figcaption>
          </li>
         {% endfor %}
      </ul>
    </div>




    {% include 'partials/_recordfooter.twig' with { 'record': record, 'extended': true } %}

{% endblock main %}

{% block bottomincludes %}

  {% if record.coordinates.latitude and record.coordinates.longitude %}
    <script>
      var map;
      var marker;
      var myLatLng = {lat: {{ record.coordinates.latitude }}, lng: {{ record.coordinates.longitude }}};
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: myLatLng,
          zoom: 14
        });

        marker = new google.maps.Marker({
          position: myLatLng,
          map: map
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{app.config.get('general/google_api_key')}}&callback=initMap"
    async defer></script>
  {% endif %}
{% endblock bottomincludes %}
